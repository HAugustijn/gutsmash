# Contains rules for well defined clusters, containing all expected functional parts

# Cutoffs and neighbourhoods are given in kilobases

RULE hydroxybenzoate2phenol
    COMMENT HadBCD operon, hydroxybenzoate to phenol
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS Flavoprotein and UbiD and not ubi_syn

RULE pdu
    COMMENT propanediol degradation pathway
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(4, [BMC, PduV-EutP, PTAC, Aldedh, Dehydratase_MU, Dehydratase_LU, Dehydratase_SU]) and  Dehydratase_MU and Dehydratase_SU and Dehydratase_LU

RULE EUT_pathway
    COMMENT ethanolamine degradation pathway
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [Aldedh, BMC, EutH, EutA]) and EutB and EutC

RULE TMA
    COMMENT trimethylamine synthesis
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(8, [PduV-EutP, RSAM_130_tma, Fer4_14, Fer4_12, PFL-like, Gly_8-9_TMA, BMC, Aldedh_7_tma, Fer4_21, Fer4_7, Fer4_9, Fer4_16])
               and  PFL-like and Gly_8-9_TMA and Aldedh_7_tma #specific hmms have been built: Radical SAM, Glycine radical and Aldehyde dehydrogenase

RULE p-cresol
    COMMENT p-cresol synthesis or HpdBCA operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS  cds(PFL-like and Gly_430_pcre) and (Radical_SAM or RSAM_130_tma)## Gly_430_pcre is a pHMM specifically built to cature glycine radical involved in this pathway


RULE arginine2spermitine_via_agmatine
    COMMENT putative arginine degradation pathway via agmatine (arg-putr-sper)
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [Sacchrp_dh_C, Sacchrp_dh_NADP, Spermine_synth, Cys_Met_Meta_PP, Aminotran_5, Aminotran_1_2, AdoMet_dc, Beta_elim_lyase, Ala_racemase_N ]) and Arginase and (OKR_DC_1_7_arginine or OKR_DC_1) and AdoMet_dc ##original pathway via agmatinase

RULE arginine2spermitine_N_carbomyl_Putrescine
    COMMENT putative arginine degradation pathway via agmatine (arg-N-carbomyl-putr-sper)
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [Sacchrp_dh_C, Sacchrp_dh_NADP, Spermine_synth, Cys_Met_Meta_PP, Aminotran_5, Aminotran_1_2, AdoMet_dc, Beta_elim_lyase, PAD_porph, OTCace, CN_hydrolase, Ala_racemase_N]) and (OKR_DC_1_7_arginine or OKR_DC_1) and Amidinotransf and Arginase #arginine degradation via N-carbomyl-Putrescine

RULE proline2aminovalerate
    COMMENT proline to aminovalerate pathway
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS Proline_reductase and (Pro_racemase or GRDB) and not ACP_syn_III_C ##ACP_syn_III_C belongs to the gly reductase pathway
    
RULE Leucine_reduction
    COMMENT Leucine reductive branch
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [Hacid_dh_C, HCDH, Acyl-CoA_dh_1, Acyl-CoA_dh_2, AdoHcyase_NAD, AlaDh_PNT_C, BcrAD_BadFG, CoA_transf_3, ETF, ETF_alpha, FGGY_C, MreB_Mbl, NAD_binding_2, Peptidase_M22, UDPG_MGDP_dh_N])
               and  minimum(2, [HleuD1, HleuD2, HleuS1, HleuS2]) # 2 specific pHMMS that define 2-hydroxyglutaryl-CoA dehydratase are required (from C. sporogenes or difficile)

RULE gallic_acid_met
    COMMENT Gallic acid metabolism
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(1, [Flavoprotein, Semialdhyde_dh, gallic_acid]) and gallic_acid #specific UbiD protein domain involved in gallic acid metabolism is required (sometimes is not clustered)

RULE bai_operon
    COMMENT From primary to secondary bile acids  via bai operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS (minimum(3, [AMP-binding, adh_short, adh_short_C2, KR, CoA_transf_3, Pyr_redox, NAD_binding_8, FAD_oxidored, FAD_binding_2]) and baiH and baiCD) or (minimum(3, [Dala_Dala_lig_C, Dala_Dala_lig_N, CPSase_L_D2, ATP-grasp_4, ATP-grasp_3, GARS_A, Acyltransferase, AMP-binding, adh_short, adh_short_C2, KR, CoA_transf_3, Pyr_redox, NAD_binding_8, FAD_oxidored, FAD_binding_2, LysM, GHMP_kinases_C, GHMP_kinases_N]) and baiH and baiCD)

RULE AAA_reductive_branch
    COMMENT Aromatic amino acid reductive branch
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(5, [HCDH, ACP_syn_III, ACP_syn_III_C, Acyl-CoA_dh_1, Acyl-CoA_dh_2, ECH_1, ECH_2, ETF, ETF_alpha, F420_oxidored, NAD_Gly3P_dh_N, SpoVAD, Thiolase_C, Thiolase_N, ketoacyl-synt]) and (HGD-D or Lactoyl-CoA1 or Lactoyl-CoA2)

RULE porA
    COMMENT porA metabolism
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [Transketolase_C, TPP_enzyme_C, PGM_PMM_I, PGM_PMM_III]) and POR and POR_N and PFOR_II
               and not cds(PFOR_II and POR_N and TPP_enzyme_C) #avoid capturing pyruvate (flavoprotein) oxidoreductase only (not sure about it)

RULE Lysine_degradation
    COMMENT Lysine degradation pathway (to butyrate)
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(1, [HBT, Fer4_12, Fer4_14, Lys-AminoMut_A]) and BKACE and LAM_C and RSAM_2_lys and B12-binding and OAM_dimer

RULE glutamate2butyric
    COMMENT glutamate to butyric acid pathway
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(4, [OAD_gamma, Biotin_lipoyl, Peptidase_M23, OAD_beta, CoA_trans, AcetylCoA_hydro, Carboxyl_trans, FGGY_C,FGGY_N, HGD-D]) and BcrAD_BadFG and HG2B1 and HG2B2

RULE acetate2butyrate
    COMMENT Acetate to butyrate pathway
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(4, [ECH_2, Thiolase_N, Thiolase_C, ketoacyl-synt, Acyl-CoA_dh_1, Acyl-CoA_dh_2, ETF, ETF_alpha]) and ECH_1 and HCDH


RULE caffeate_respiration
    COMMENT caffeate respiration
    SUPERIORS acetate2butyrate
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(2, [Acyl-CoA_dh_2, HpaB_N, HpaB]) and CoA_trans_2_CAF and Acyl-CoA_dh_1 #specific CoA_transferase for caffeate respiration is required

RULE carnitine_degradaion_caiTABCDE
    COMMENT carnitine degradation via caiTABCDE operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(4, [BCCT, CoA_transf_3, AMP-binding, ECH_2, Hexapep, Hexapep_2, Acyl-CoA_dh_1, Acyl-CoA_dh_2]) and Hexapep and ECH1_8_CARC #specific ECH_1 for carnitine met is required

RULE carnitine_degradation_fixABCX
    COMMENT carnitine degradation via fixABCX operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(5, [ETF, ETF_alpha, DAO, FAD_binding_3, FAD_binding_2, NAD_binding_8, Trp_halogenase, GMC_oxred_N, Pyr_redox, Lycopene_cycl, Pyr_redox_3, ApbA, NAD_binding_9, ETF_QO]) and Pyr_redox_2 and FAD_oxidored

RULE aminobutyrate2Butyrate
    COMMENT butyrate synthesis from (4)aminobutyrate
    CUTOFF 10
    NEIGHBOURHOOD 10
    CONDITIONS (cds(Fe-ADH and Fe-ADH_2) and cds(AcetylCoA_hyd_C and AcetylCoA_hydro)) or (cds(Fe-ADH and Fe-ADH_2) and cds(AcetylCoA_hyd_C and AcetylCoA_hydro) and  cds(HpaB_N and HpaB)) #either from 4-hydroxybutyrate or via crotonoyl-CoA

RULE succinate2propionate
    COMMENT succinate to propionate pathway
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS (minimum(3, [AcetylCoA_hyd_C, AcetylCoA_hydro, MM_CoA_mutase, B12-binding, MeaB, ATP_bind_1, Glyoxalase_4, Glyoxalase, Glyoxalase_3, MdcE]) and (CT_Propionyl_CoA1 or CT_Propionyl_CoA2 or CT_Propionyl_CoA3))
               #or (CT_Propionyl_CoA1 or CT_Propionyl_CoA2 or CT_Propionyl_CoA3) #succinate2propionate complete pathway or priopionyl-CoA (transferase) marker

RULE acrylate2propionate
    COMMENT acrylate to propionate pathway
    SUPERIORS AAA_reductive_branch
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [CoA_trans, CoA_trans_230_acto, Mal_decarbox_Al, AcetylCoA_hydro, BcrAD_BadFG, FGGY_C, FGGY_N, Acyl-CoA_dh_1]) and minimum(1, [Lactoyl-CoA2, Lactoyl-CoA1]) #(Lactoyl-CoA2 or Lactoyl-CoA1) #complete pathway or just the pHMMs specific to the Lactoyl-CoA transferase (markers)


RULE Threonine2propionate
    COMMENT Threonine to propionate pathway via tdcABCDEFG operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [SDH_alpha, SDH_beta, MmgE_PrpD, Acetate_kinase, Trp_Tyr_perm, LysR_substrate]) and PFL-like and Gly_radical and PALP


RULE Arginine2_Hcarbonate
    COMMENT Arginine to hydrogene carbonate pathway
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS Amidinotransf and OTCace and OTCace_N and AA_kinase ##Arginine to hydrogene carbonate pathway

RULE Glycine_reductase
    COMMENT Glycine reductase, from glycine to acetyl-P
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [ACP_syn_III_C, GRDB, GRDA, ACP_syn_III, FA_synthesis]) and Glycine_reductase and not Pro_racemase #Pro_racemase belongs to the proline2aminovalerate cluster

RULE Glycine_cleavage
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(2, [GCV_T, SoxG, GCV_H, GDC-P, Aminotran_5]) and GCV_H and GCV_T_C

RULE arginine_degradation_astABCDE_operon
    COMMENT Arginine degradation to pytruvate via astABCDE operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(3, [Met_asp_mut_E, Aminotran_3, Aminotran_1_2, Aldedh, AstE_AspA, ICL, PEP_mutase, Malate_synthase]) and AstA and AstB

RULE histidine2glutamate_hutHGIU_operon
    COMMENT Histidine to glutamate via hutHGIU operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(2, [Lyase_aromatic, Urocanase, Amidohydro_3, Amidohydro_1, FGase]) and Arginase and Urocanase_C

RULE Glutamate2pyruvate
    COMMENT Glutamate degradation to pyruvate (to CHECK)
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(2, [MR_MLE_C, Met_asp_mut_E, B12-binding]) and MAAL_C or MAAL_N

RULE Galacturonate_degradation
    COMMENT Galacturonate degradation to dehydro3deoxyDgluconate via uxaABC operon
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(2, [UxaC, Mannitol_dh_C, Mannitol_dh]) and GD_AH_C

RULE Leucine2acetoacetate
    COMMENT Leucine degradation to acetoacetate
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(5, [Aminotran_4, Carboxyl_trans, ECH_1, ECH_2, HMGL-like, oxoacid_dh, Transket_pyr,Transketolase_C, OxoDH_E1alpha_N]) and minimum(1, [Acyl-CoA_dh_1, Acyl-CoA_dh_2]) and not Thiolase_C ##Thiolase_C is present in acetate2butyrate, helps to differentiate

RULE Glycerol2glyceroneP
    COMMENT Glycerol degradation to glycerone phosphate
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS Fe-ADH and Fe-ADH_2 and Dak1 and Dak2

RULE Pyruvate2succinyl
    COMMENT Pyruvate fermentation to succinyl_CoA
    CUTOFF 20
    NEIGHBOURHOOD 10
    CONDITIONS minimum(7, [Biotin_lipoyl, Biotin_lipoyl_2, PYC_OADA, HMGL-like, Carboxyl_trans, MdcE, Ldh_1_C, Ldh_1_N, Lyase_1, FumaraseC_C, FAD_binding_2, Succ_DH_flav_C, Fumarate_red_D, Fumarate_red_C, AcetylCoA_hydro, AcetylCoA_hyd_C, CitF])


#RULE GABA_synthesis
#    COMMENT from glutamate or putrescine to GABA
#    CUTOFF 20
#    NEIGHBOURHOOD 10
#    CONDITIONS minimum(4, [Gln-synt_C, Peptidase_C26, GATase, Aldedh, DAO, NAD_binding_8, FAD_binding_3])

